{{#>base page="category"}}

  <style>
    .category-header {
      display: flex;
      gap: .8em;
      align-items: center;
    }

    .category-facets {
      font-size: .8em;
      font-variant: small-caps;
    }
  </style>

  <h1>{{settings.site.title}}</h1>

  <header class="category-header">
    <h2><a href="{{category.permalink}}">{{category.title}}</a></h2>

    {{#if category.facets.length}}
    <div class="category-facets">
      {{#if (is category.permalink '/')}}
      <a href="by">by</a>:
      {{else}}
      <a href="{{category.permalink}}/by">by</a>:
      {{/if}}
      {{#each category.facets as |facet|}}
      <a href="{{facet.permalink}}">{{facet.title}}</a>
      {{/each}}
    </div>
    {{/if}}
  </header>

  {{> @partial-block }}

  {{#if category.categories.length}}
  <h3>Posts by subcategories</h3>
  {{#each category.categories as |subcategory| }}
    <h4><a href="{{subcategory.permalink}}">{{subcategory.title}}</a></h4>
    <ul>
      {{#each subcategory.posts as |post|}}
      <li><a href="{{post.permalink}}">{{post.title}}</a></li>
      {{/each}}
    </ul>
  {{/each}}
  {{/if}}

  <h3>All posts</h3>
  <ul>
    {{#each category.posts as |post|}}
    <li><a href="{{post.permalink}}">{{post.title}}</a></li>
    {{/each}}
  </ul>
{{/base}}
